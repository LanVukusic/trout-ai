# Pytorch dataset loader for autogenerated position captions

## Intuition

Despite the huge amount of games played online and the huge amount of data available, there is still a lack of data when it comes to a clean dataset of anotated chess positions for training language modoels in connection to chess.  
Available data on lichess.org exists, but needs to be hand curated and is not easily accessible.  
I believe that chess.com has a similar dataset, but it is not publicly available.

## Idea and use cases

The idea is to use a huge amount of available unanonated chess positions and generate a dataset of anotated chess positions based on computable pre-defined rules.  
Dataset which I have in mind would consist of:  

### implemented

- possible captures of unprotected pieces
  - "Queen on D4 can be captured by enemy rook on H8"
  - "Knight on E2 can be captured by enemy bishop on C1"
- possible checks
  - "Queen on D4 can check enemy king on H8"
  - "Rook on H8 can check enemy king on D4"

### to be implemented

- pinned pieces
  - "Queen on D4 is pinned by enemy rook on H8"
  - "Knight on E2 is pinned by enemy bishop on C1"
- threats
  - "Queen on D4 threatens our rook on H8"
- blunders and mistakes
  - "Queen on D4 is hanging"
  - "Rook on H8 is hanging"
  - "move 1. e4 is a blunder"
  - "missing a checkmate in 1 move"
- mates in 1, 2 and 3 moves
  - "mate in 1, by queen on D4"
  - "mate in 2, with rook on H8 and queen on D4"
  - "mate in 3, with rook on H8, queen on D4 and bishop on C1"
- engine evaluations
  - "position is rather even"
  - "position is slightly better for white"
  - "position is 8 pawns better for black"

Dataset of such sort can be created with computationally cheap rules and can be used to train a coarse version of a language model.  
I believe that such model can later be tuned on a smaller curated set of properly anotated positions.  

## Approach

Use a list of games and sample positions from different parts of the game (rather equaly if possible).  
For each position, generate a caption based on the rules above.  This will generate a lage chunk of text data for each position which can later be distilled down or randomly sampled for training.

https://www.kaggle.com/code/mdteach/image-captioning-with-attention-pytorch


